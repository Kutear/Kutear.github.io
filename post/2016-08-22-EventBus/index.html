<!DOCTYPE html>
<html>
  <head lang="zh">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black" name="apple-mobile-web-app-status-bar-style"/>
<meta content="telephone=no" name="format-detection"/>
<meta name="renderer" content="webkit">
<meta name="description" content="æ¸©æ•…è€ŒçŸ¥æ–°">
<meta http-equiv="Access-Control-Allow-Origin" content="*">

<title>EventBusæºç åˆ†æ | KuTeat</title>
<link href="https://kutear.github.io/styles/main.css" type="text/css" rel="stylesheet"/>
<link rel="stylesheet" href="//cdn.bootcss.com/KaTeX/0.10.2/katex.min.css"/>
<script src="//cdn.bootcss.com/KaTeX/0.10.2/katex.min.js"></script>
<script src="//cdn.bootcss.com/KaTeX/0.10.2/contrib/auto-render.min.js"></script>
<script type="text/javascript" src="https://kutear.github.io/media/scripts/jquery.js"></script>
<script type="text/javascript" src="https://kutear.github.io/media/scripts/jquery.pjax.min.js"></script>
<script type="text/javascript" src="https://kutear.github.io/media/scripts/basic.js"></script>
<script type="text/javascript" src="//cdn.bootcss.com/gitalk/1.5.0/gitalk.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
<script async type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script async type="text/javascript" src="https://kutear.github.io/media/scripts/search.js"></script>
<script type="text/javascript">
$(document).pjax('a[target!=_blank]', '#pjax-container', {
	fragment: '#pjax-container',
	timeout: 5000,
	cache: false
});
$(document).on('pjax:complete', function(){  	
	pjax();
});

$(window).on('popstate.pjax', function () {
	pjax();
})

function pjax() {
	$.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");

	if (("#gitalk-container").length > 0 ) {
	$('#mememe').attr('src','//source.unsplash.com/800x400/?arts,weather?'+Math.random());
	$.getScript("//cdn.bootcss.com/KaTeX/0.10.2/katex.min.js");
	$.getScript("//cdn.bootcss.com/KaTeX/0.10.2/contrib/auto-render.min.js");
	$('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
    	});
	}
}
</script>

  </head>

  <body>
     <div class="header">
      <div class="logo_title">
		  
        <div class="title animated fadeInDown"><img id="img1" style="display:inline-block;" src="https://kutear.github.io/images/avatar.png"/>
<script>
var r = 0;
    window.onload = function(){
        var current = 0;
        document.getElementById('img1').onclick = function(){
            current = (current+90)%360;
            this.style.transform = 'rotate('+current+'deg)';
        }
    };
</script>
          <h1 title="KuTeat" class="weaklink"><a  href="/">KuTeat</a>

          </h1>

          <div class="navbar weaklink">
            <div class="normal_nav">

<div class="bitcron_nav_container">


  <div class="bitcron_nav">
    <div class="mixed_site_nav_wrap site_nav_wrap">
		
      <ul class="mixed_site_nav site_nav sm sm-base">
	  
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a>
  </li>
  
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a>
  </li>
  
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a>
  </li>
  
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a>
  </li>
  
 
 <li>

      </ul>
	  

      <div class="clear clear_nav_inline_end"></div>
<div class="search">
    <i class="search-icon fa fa-search search-start"></i>
    <input type="text" class="search-input" placeholder="Searching..." />
    <i class="search-icon fa fa-refresh search-clear"></i>
	<div class="search-results"></div>
</div>
    </div>

  </div>



  <div class="clear clear_nav_end"></div>

</div>

            </div>
			
			<div class="hamberger"><i class="fa fa-bars"></i>
<i class="fa fa-times"></i>

			</div>

          </div>

        </div>

      </div>

      <div class="hidden_nav animated fadeInDown">

<div class="bitcron_nav_container">


  <div class="bitcron_nav">
    <div class="mixed_site_nav_wrap site_nav_wrap">
      <ul class="mixed_site_nav site_nav sm sm-base">
	
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a>

  </li>


  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a>

  </li>


  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a>

  </li>


  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a>

  </li>




      </ul>

      <div class="clear clear_nav_inline_end"></div>
    </div>

  </div>



  <div class="clear clear_nav_end"></div>

</div>

      </div>

    </div>

<style type="text/css">
.search {
    position: relative;
    height: 30px;
    text-align: right;
    line-height: 30px;
    padding-right: 10px;
}

.search .search-icon {
    float: right;
    height: 100%;
    margin: 0 10px;
    line-height: 30px;
    cursor: pointer;
    user-select: none;
}

.search .search-input {
    float: right;
    width: 30%;
    height: 30px;
    line-height: 30px;
    margin: 0;
    border: 2px solid #ddd;
    border-radius: 10px;
    box-sizing: border-box;
}

.search .search-clear {
    display: none;
}

.search .search-results {
    display: block;
    z-index: 1000;
    position: absolute;
    top: 30px;
    right: 50px;
    width: 50%;
    max-height: 400px;
    overflow: auto;
    text-align: left;
    border-radius: 5px;
    box-shadow: 0 .3rem .5rem #333;
}

.search .search-results .result-item {
    color: #000;
    margin: 5px;
    padding: 3px;
    border-radius: 3px;
    cursor: pointer;
}

</style>

    <div class="main" id="pjax-container">
      <div class="main-inner">


<div class="content">






  <div class="post_page" >

<div class="post">
  <div class="post_title sm_margin">
    <h2><a>EventBusæºç åˆ†æ</a>



    </h2>
  </div>
  
<script>
function lan(){
	if (document.getElementById("lan").innerText == "ç¹"){
		var s=document.getElementById("tongwenlet_cn");
		if(s != null){
		document.body.removeChild(s);
		}
		var s = document.createElement("script");
		s.language = "javascript";
		s.type = "text/javascript";
		s.src = "https://git.oschina.net/runningcheese/JiathisQR.js/raw/master/bookmarklet_tw.js";
		s.id = "tongwenlet_cn";
		document.body.appendChild(s);
		document.getElementById("lan").innerHTML = "ç®€"
	}
	else if(document.getElementById("lan").innerText == "ç°¡"){
		var s=document.getElementById("tongwenlet_cn");
		if(s != null){
		document.body.removeChild(s);
		}
		var s = document.createElement("script");
		s.language = "javascript";
		s.type = "text/javascript";
		s.src = "https://git.oschina.net/runningcheese/JiathisQR.js/raw/master/bookmarklet_cn.js";
		s.id = "tongwenlet_cn";
		document.body.appendChild(s);
		document.getElementById("lan").innerHTML = "ç¹"
		}
}

function change(){	
    var rand = Math.random()*1+1;
    var num = window.getComputedStyle(document.getElementsByName("show")[0],undefined).fontSize;
	num = num.slice(0,-2); 
    document.getElementById("show").style.fontSize = num - rand +'px';
}
</script>

  <div class="post_details">
    <div class="info"><i class="fa fa-clock-o"></i>
<span class="date_info">2016-08-22</span>
<i class="fa fa-eye"></i>

<span class="date_info"><span id="busuanzi_value_page_pv"></span> Views</span>

<i class="fa fa-bookmark-o"></i>
<span class="tags_info weaklink">
	
	<a href="https://kutear.github.io/tag/m8i70eBHPt" class="tag">Thinking In Java</a>


</span>
<span>16 min read</span>
&nbsp
&nbsp
<i class="fa fa-share"></i>
<a title="QR code" target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://kutear.github.io/post/2016-08-22-EventBus"><i class="fa fa-qrcode"></i></a>
<a title="qq share" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://kutear.github.io/post/2016-08-22-EventBus&sharesource=qzone&title=EventBusæºç åˆ†æ&pics=https://blog.blinkstar.cn/images/avatar.png&summary="><i class="fa fa-qq"></i></a>
<a title="weibo share" target="_blank" href="https://service.weibo.com/share/share.php?url=https://kutear.github.io/post/2016-08-22-EventBus&sharesource=weibo&title=EventBusæºç åˆ†æ + " - " + &pic="https://blog.blinkstar.cn/images/avatar.png"><i class="fa fa-weibo"></i></a>
&nbsp
&nbsp
<a id="daxiao" href="javascript:void(0);" onclick="change();" title="è°ƒæ•´å­—ä½“å¤§å°"><i class="fa fa-font"></i></a>
&nbsp
&nbsp
<a id="lan" href="javascript:void(0);" onclick="lan();" title="è°ƒæ•´ç®€ç¹ä½“">ç¹</a>
</div>
  </div>

  <div class="post_content markdown">
  &nbsp
  <img id="mememe" src="//source.unsplash.com/800x400/?arts,weather">
    <div name="show" id="show">
	<p class="md_block"><span class="md_line md_line_start md_line_end"><h1 id="æœ€ç®€å•çš„ä¾‹å­è¯´èµ·">æœ€ç®€å•çš„ä¾‹å­è¯´èµ·</h1>
<p>å…ˆä»ä¸€ä¸ªç®€å•çš„æ —å­å‡ºå‘ï¼Œçœ‹çœ‹<code>EventBus</code>çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆã€‚</p>
<pre><code class="language-java">@Override
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        EventBus.getDefault().register(this);
        findViewById(R.id.say_hello).setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                EventBus.getDefault().post(new EventBean(1,&quot;Hello&quot;));
            }
        });
}

@Subscribe(threadMode = ThreadMode.MAIN) //åœ¨uiçº¿ç¨‹æ‰§è¡Œ
public void onEvent(EventBean event) {
        System.out.println(Thread.currentThread().getName());
}

@Override
protected void onDestroy() {
        super.onDestroy();
        EventBus.getDefault().unregister(this);
}
</code></pre>
<p>ä¸Šé¢çš„ä»£ç æ˜¯æœ€ç®€å•çš„ä¸€ä¸ªäº‹ä»¶ï¼Œå½“ç‚¹å‡»æŒ‰é’®ä¹‹åå›è°ƒ<code>onEvent()</code>æ–¹æ³•ã€‚ä¸‹é¢å°±ç€é‡çœ‹çœ‹è¿™ä¸ªè¿‡ç¨‹çš„å®ç°ã€‚ç±»ä¼¼çš„ä»£ç æˆ‘ä»¬è§å¾—å¾ˆå¤šï¼Œæ¯”å¦‚Appå­˜åœ¨ä¸€ä¸ª<code>UserManager</code>,æœ‰ä¸€ä¸ªç”¨æˆ·çŠ¶æ€çš„åˆ†å‘ï¼Œå¾ˆå¤šç±»åœ¨è¿™é‡Œæ³¨å†Œäº†ç”¨æˆ·çŠ¶æ€çš„ç›‘å¬å›è°ƒï¼Œå½“ç”¨æˆ·ç™»é™†ï¼Œæ‰€æœ‰çš„æ³¨å†Œäº†ç›‘å¬çš„ç±»éƒ½ä¼šæ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯ã€‚å…¶å®<code>EventBus</code>çš„å®ç°ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯ä¸å­˜åœ¨æ¥å£ã€‚<br>
çœ‹çœ‹ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¯¹æ˜¯æ€æ ·å›è°ƒ<code>onEvent()</code>æ„Ÿåˆ°ä¸€ä¸çš„å›°æƒ‘ã€‚ä¸‹é¢è¿›å…¥æºç çš„ä¸–ç•Œã€‚</p>
<h1 id="eventbus-æºç åˆ†æ">EventBus æºç åˆ†æ</h1>
<p>å…ˆçœ‹çœ‹ä¸€äº›æœ‰ç”¨çš„å­—æ®µ</p>
<pre><code class="language-java">    //K-&gt;æ–¹æ³•å‚æ•°çš„ç±»å‹   V-&gt;Kçš„æ‰€æœ‰çˆ¶ç±»çš„ç»“åˆï¼ˆåŒ…æ‹¬æœ¬èº«ï¼‰ ç”¨ä½œç¼“å­˜
    private static final Map&lt;Class&lt;?&gt;, List&lt;Class&lt;?&gt;&gt;&gt; eventTypesCache = new HashMap&lt;&gt;();
    //K-&gt;æ–¹æ³•å‚æ•°çš„ç±»å‹   V-&gt;æ‰€æœ‰å‚æ•°ç±»å‹çš„Kçš„è®¢é˜…å‡½æ•°çš„é›†åˆ  ä¸»è¦æ˜¯æ¶ˆæ¯å‘é€ä½¿ç”¨
    private final Map&lt;Class&lt;?&gt;, CopyOnWriteArrayList&lt;Subscription&gt;&gt; subscriptionsByEventType;
    //K-&gt;æ³¨å†Œçš„ç±»ï¼Œå¦‚Activity  V-&gt; æ³¨å†Œç±»çš„æ³¨å†Œå‡½æ•°çš„å‚æ•°çš„é›†åˆ  ä¸»è¦æ˜¯æ³¨å†Œ/è§£ç»‘ä½¿ç”¨
    private final Map&lt;Object, List&lt;Class&lt;?&gt;&gt;&gt; typesBySubscriber;
    //ç²˜æ€§äº‹ä»¶ K-&gt;å‘å‡ºçš„äº‹ä»¶çš„å‚æ•°ç±»å‹  V-&gt;äº‹ä»¶çš„å€¼
    private final Map&lt;Class&lt;?&gt;, Object&gt; stickyEvents;
</code></pre>
<h2 id="ä¸€åˆ‡çš„å¼€å§‹-äº‹ä»¶çš„è®¢é˜…">ä¸€åˆ‡çš„å¼€å§‹-äº‹ä»¶çš„è®¢é˜…</h2>
<pre><code class="language-java">//EventBus
public void register(Object subscriber) {
        Class&lt;?&gt; subscriberClass = subscriber.getClass();
        //è·å–è¯¥ç±»çš„æ‰€æœ‰çš„èƒ½æ¥å—äº‹ä»¶çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è¯´çš„`onEvent(...)`
        List&lt;SubscriberMethod&gt; subscriberMethods = subscriberMethodFinder.findSubscriberMethods(subscriberClass);
        synchronized (this) {
            for (SubscriberMethod subscriberMethod : subscriberMethods) {
                subscribe(subscriber, subscriberMethod);
            }
        }
}
</code></pre>
<p>å¦‚ä½•æ‰èƒ½æ‰¾åˆ°æ³¨å†Œçš„æ–¹æ³•å‘¢,è¿™å°±è¦çœ‹çœ‹<code>SubscriberMethodFinder</code>çš„å…·ä½“å®ç°äº†.</p>
<pre><code class="language-java">//SubscriberMethodFinder
List&lt;SubscriberMethod&gt; findSubscriberMethods(Class&lt;?&gt; subscriberClass) {
        //æå‡é€Ÿåº¦ï¼Œä¼˜å…ˆé‡ç¼“å­˜ä¸­å–,æ”¯æŒå¹¶å‘æ“ä½œ
        //å£°æ˜ä¸º Map&lt;Class&lt;?&gt;, List&lt;SubscriberMethod&gt;&gt; METHOD_CACHE = new ConcurrentHashMap&lt;&gt;();
        List&lt;SubscriberMethod&gt; subscriberMethods = METHOD_CACHE.get(subscriberClass);
        if (subscriberMethods != null) {
            return subscriberMethods;
        }
        if (ignoreGeneratedIndex) { //é»˜è®¤ä¸ºfalse
            subscriberMethods = findUsingReflection(subscriberClass);
        } else {
            subscriberMethods = findUsingInfo(subscriberClass);
        }

        if (subscriberMethods.isEmpty()) {
            throw new EventBusException(&quot;Subscriber &quot; + subscriberClass
                    + &quot; and its super classes have no public methods with the @Subscribe annotation&quot;);
        } else {
            METHOD_CACHE.put(subscriberClass, subscriberMethods);
            return subscriberMethods;
        }
}

private List&lt;SubscriberMethod&gt; findUsingInfo(Class&lt;?&gt; subscriberClass) {
        //ä»å¤ç”¨æ± ä¸­å–å›ä¸€ä¸ªFindState
        FindState findState = prepareFindState();
        //ä¸ºfindStateè®¾ç½®clazzç­‰å‚æ•°
        findState.initForSubscriber(subscriberClass);
        while (findState.clazz != null) {
            findState.subscriberInfo = getSubscriberInfo(findState);
            //é€šå¸¸ä¸ºNULL
            if (findState.subscriberInfo != null) {
                SubscriberMethod[] array = findState.subscriberInfo.getSubscriberMethods();
                for (SubscriberMethod subscriberMethod : array) {
                    if (findState.checkAdd(subscriberMethod.method, subscriberMethod.eventType)) {
                        findState.subscriberMethods.add(subscriberMethod);
                    }
                }
            } else {
                findUsingReflectionInSingleClass(findState);
            }
            //è®¾ç½®findState.clazzä¸ºåˆšåˆšclazzçš„çˆ¶ç±»
            findState.moveToSuperclass();
        }
        //è·å–findState.subscriberMethods
        return getMethodsAndRelease(findState);
}
</code></pre>
<p>å†çœ‹<code>findUsingReflectionInSingleClass()</code>ä¹‹å‰,çº¿çœ‹çœ‹<code>FindState</code>çš„ä¸€éƒ¨åˆ†å®ç°</p>
<pre><code class="language-java">//FindState
static class FindState {
  	//è®¢é˜…è€…çš„æ–¹æ³•çš„åˆ—è¡¨
	final List&lt;SubscriberMethod&gt; subscriberMethods = new ArrayList&lt;&gt;();
  	//ä»¥EventTypeä¸ºkeyï¼Œmethodä¸ºvalue
	final Map&lt;Class, Object&gt; anyMethodByEventType = new HashMap&lt;&gt;();
	//ä»¥methodçš„åå­—ç”Ÿæˆä¸€ä¸ªmethodKeyä¸ºkeyï¼Œè¯¥methodçš„ç±»(è®¢é˜…è€…)ä¸ºvalue
        final Map&lt;String, Class&gt; subscriberClassByMethodKey = new HashMap&lt;&gt;();
        //æ„å»ºmethodKeyçš„StringBuilder
	final StringBuilder methodKeyBuilder = new StringBuilder(128);
	//è®¢é˜…è€…
	Class&lt;?&gt; subscriberClass;
        //å½“å‰ç±»
	Class&lt;?&gt; clazz;
        //æ˜¯å¦è·³è¿‡çˆ¶ç±»
	boolean skipSuperClasses;
       //SubscriberInfo
	SubscriberInfo subscriberInfo;

	void initForSubscriber(Class&lt;?&gt; subscriberClass) {
      	//clazzä¸ºå½“å‰ç±»
		this.subscriberClass = clazz = subscriberClass;
		skipSuperClasses = false;
		subscriberInfo = null;
	}
  	
        boolean checkAdd(Method method, Class&lt;?&gt; eventType) { //å¸¦æ£€æµ‹æ–¹æ³•ï¼Œå’Œä»–çš„å‚æ•°ç±»å‹
            // 2 level check: 1st level with event type only (fast), 2nd level with complete signature when required.
            // Usually a subscriber doesn't have methods listening to the same event type.
            Object existing = anyMethodByEventType.put(eventType, method);
            if (existing == null) {
                return true;
            } else {
                if (existing instanceof Method) {
                    if (!checkAddWithMethodSignature((Method) existing, eventType)) { //æ£€æµ‹å‡½æ•°çš„ç­¾å
                        // Paranoia check
                        throw new IllegalStateException();
                    }
                    // Put any non-Method object to &quot;consume&quot; the existing Method
                    anyMethodByEventType.put(eventType, this);
                }
                return checkAddWithMethodSignature(method, eventType);
            }
       }
    
       private boolean checkAddWithMethodSignature(Method method, Class&lt;?&gt; eventType) {
            methodKeyBuilder.setLength(0);
            methodKeyBuilder.append(method.getName());
            methodKeyBuilder.append('&gt;').append(eventType.getName());

            String methodKey = methodKeyBuilder.toString();
            Class&lt;?&gt; methodClass = method.getDeclaringClass();  //æ‰¾åˆ°å£°æ˜è¯¥æ–¹æ³•çš„ç±»
            Class&lt;?&gt; methodClassOld = subscriberClassByMethodKey.put(methodKey, methodClass);
            if (methodClassOld == null || methodClassOld.isAssignableFrom(methodClass)) {
                //åˆ¤æ–­oldæ˜¯å¦ä¸ºmethodClassçš„çˆ¶ç±»
                // Only add if not already found in a sub class
                return true;
            } else {
                // Revert the put, old class is further down the class hierarchy
                subscriberClassByMethodKey.put(methodKey, methodClassOld);
                return false;
            }
      	}
}
</code></pre>
<p>Ok,ä¸‹é¢çœ‹çœ‹<code>findUsingReflectionInSingleClass()</code>çš„å®ç°å§.</p>
<pre><code class="language-java">private void findUsingReflectionInSingleClass(FindState findState) {
        Method[] methods;
        try {
            // This is faster than getMethods, especially when subscribers are fat classes like Activities
            methods = findState.clazz.getDeclaredMethods();//è¿”å›è¯¥ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬ç»§æ‰¿å¾—æ¥çš„
        } catch (Throwable th) {
            // Workaround for java.lang.NoClassDefFoundError, see https://github.com/greenrobot/EventBus/issues/149
            methods = findState.clazz.getMethods();
            findState.skipSuperClasses = true;
        }
        for (Method method : methods) {
            int modifiers = method.getModifiers(); //æ–¹æ³•çš„ä¿®é¥°ç¬¦ public|protected|private|default(package)
            if ((modifiers &amp; Modifier.PUBLIC) != 0 &amp;&amp; (modifiers &amp; MODIFIERS_IGNORE) == 0) { //å¤§ä½“ä¸Šå°±æ˜¯è¦æ±‚public,éstatic|abstract
                Class&lt;?&gt;[] parameterTypes = method.getParameterTypes(); //è·å–å‚æ•°ç±»å‹æ•°ç»„
                if (parameterTypes.length == 1) {  //åªå…è®¸æœ‰ä¸€ä¸ªå‚æ•°
                    Subscribe subscribeAnnotation = method.getAnnotation(Subscribe.class);
                    if (subscribeAnnotation != null) { //å‡½æ•°å¿…é¡»åŒ…å«æ³¨è§£
                        Class&lt;?&gt; eventType = parameterTypes[0];
                        if (findState.checkAdd(method, eventType)) {
                            ThreadMode threadMode = subscribeAnnotation.threadMode();
                            findState.subscriberMethods.add(new SubscriberMethod(method, eventType, threadMode,
                                    subscribeAnnotation.priority(), subscribeAnnotation.sticky()));
                        }
                    }
                } else if (strictMethodVerification &amp;&amp; method.isAnnotationPresent(Subscribe.class)) {
                    String methodName = method.getDeclaringClass().getName() + &quot;.&quot; + method.getName();
                    throw new EventBusException(&quot;@Subscribe method &quot; + methodName +
                            &quot;must have exactly 1 parameter but has &quot; + parameterTypes.length);
                }
            } else if (strictMethodVerification &amp;&amp; method.isAnnotationPresent(Subscribe.class)) {
                String methodName = method.getDeclaringClass().getName() + &quot;.&quot; + method.getName();
                throw new EventBusException(methodName +
                        &quot; is a illegal @Subscribe method: must be public, non-static, and non-abstract&quot;);
            }
        }
}

</code></pre>
<p>ç°åœ¨å‡½æ•°è°ƒç”¨æ ˆé€€å›åˆ°äº†æœ€å¼€å§‹çš„<code>register()</code>,æ¥ç€çœ‹<code>subscribe(...)</code>æ–¹æ³•ã€‚</p>
<pre><code class="language-java">// Must be called in synchronized block
private void subscribe(Object subscriber, SubscriberMethod subscriberMethod) {
        Class&lt;?&gt; eventType = subscriberMethod.eventType; //å‚æ•°ç±»å‹
        //å°†æ³¨å†Œç±»å’Œæ–¹æ³•æ‰“åŒ…ä¸ºSubscription
        Subscription newSubscription = new Subscription(subscriber, subscriberMethod);
        CopyOnWriteArrayList&lt;Subscription&gt; subscriptions = subscriptionsByEventType.get(eventType);
        if (subscriptions == null) {
            subscriptions = new CopyOnWriteArrayList&lt;&gt;();
            subscriptionsByEventType.put(eventType, subscriptions);
        } else {
            //åŒä¸€ä¸ªäº‹ä»¶ä¸å†å¤šæ¬¡æ³¨å†Œï¼Œæ‰€ä»¥æ¯æ¬¡ä½¿ç”¨åä¸€å®šè¦è§£ç»‘ï¼Œä¸è§£ç»‘è¿˜ä¼šå†…å­˜æ³„éœ²
            if (subscriptions.contains(newSubscription)) {
                throw new EventBusException(&quot;Subscriber &quot; + subscriber.getClass() + &quot; already registered to event &quot;
                        + eventType);
            }
        }

        int size = subscriptions.size();
        for (int i = 0; i &lt;= size; i++) {
            //æ ¹æ®ä¼˜å…ˆçº§æ”¾å…¥åˆé€‚çš„ä½ç½®
            if (i == size || subscriberMethod.priority &gt; subscriptions.get(i).subscriberMethod.priority) {
                subscriptions.add(i, newSubscription);
                break;
            }
        }
        //typesBySubscriber  K-&gt;æ³¨å†Œçš„ç±»ï¼Œå¦‚Activity  V-&gt; æ³¨å†Œç±»çš„æ³¨å†Œå‡½æ•°çš„å‚æ•°çš„é›†åˆ
        List&lt;Class&lt;?&gt;&gt; subscribedEvents = typesBySubscriber.get(subscriber);
        if (subscribedEvents == null) {
            subscribedEvents = new ArrayList&lt;&gt;();
            typesBySubscriber.put(subscriber, subscribedEvents);
        }
        subscribedEvents.add(eventType);
        //æ³¨å†Œçš„æ—¶å€™åˆ¤æ–­æ˜¯å¦æœ‰ç²˜æ€§äº‹ä»¶ï¼Œå¦‚æœ‰å°±æ‰§è¡Œå’¯
        if (subscriberMethod.sticky) {
            if (eventInheritance) {  //Default true
                // Existing sticky events of all subclasses of eventType have to be considered.
                // Note: Iterating over all events may be inefficient with lots of sticky events,
                // thus data structure should be changed to allow a more efficient lookup
                // (e.g. an additional map storing sub classes of super classes: Class -&gt; List&lt;Class&gt;).
                Set&lt;Map.Entry&lt;Class&lt;?&gt;, Object&gt;&gt; entries = stickyEvents.entrySet();
                for (Map.Entry&lt;Class&lt;?&gt;, Object&gt; entry : entries) {
                    Class&lt;?&gt; candidateEventType = entry.getKey();
                    //åˆ¤æ–­eventTypeæ˜¯å¦ä¸ºcandidateEventTypeçš„çˆ¶ç±»ï¼Œå³æ‰€æœ‰çš„å­ç±»éƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯
                    if (eventType.isAssignableFrom(candidateEventType)) {
                        Object stickyEvent = entry.getValue();
                        //å‘é€æ¶ˆæ¯ï¼Œè¿™é‡Œå…ˆä¸è®²ï¼Œåœ¨åé¢ä¹Ÿä¼šè¯´çš„
                        checkPostStickyEventToSubscription(newSubscription, stickyEvent);
                    }
                }
            } else {
                Object stickyEvent = stickyEvents.get(eventType);
                checkPostStickyEventToSubscription(newSubscription, stickyEvent);
            }
        }
}
</code></pre>
<p>ä¸Šé¢æ³¨å†Œçš„è¿‡ç¨‹åŸºæœ¬å·²ç»è¯´å®Œï¼Œä¸‹é¢å°†è®²äº‹ä»¶çš„å‘é€è¿‡ç¨‹ã€‚æ ¹æ®æœ€ä¸Šé¢çš„æ —å­ï¼Œæˆ‘ä»¬çŸ¥é“å…¥å£æ˜¯<code>post()</code>å‡½æ•°ï¼Œä¸‹é¢å°±å…¥æ‰‹<code>post()</code>å‡½æ•°ã€‚</p>
<h2 id="äº‹ä»¶çš„å‘é€">äº‹ä»¶çš„å‘é€</h2>
<pre><code class="language-java">//ä¿è¯æ¯ä¸ªçº¿ç¨‹å–å¾—çš„PostingThreadStateä¸åŒï¼Œä½†æ˜¯ç›¸åŒçº¿ç¨‹å–å¾—çš„ç›¸åŒï¼Œæœ¬è´¨å°±æ˜¯HashMap&lt;Thread,PostingThreadState&gt;
private final ThreadLocal&lt;PostingThreadState&gt; currentPostingThreadState = new ThreadLocal&lt;PostingThreadState&gt;() {
        @Override
        protected PostingThreadState initialValue() {
            return new PostingThreadState();
        }
};

final static class PostingThreadState {
        final List&lt;Object&gt; eventQueue = new ArrayList&lt;Object&gt;();
        boolean isPosting;
        boolean isMainThread;
        Subscription subscription;
        Object event;
        boolean canceled;
}

public void post(Object event) {
        PostingThreadState postingState = currentPostingThreadState.get();
        List&lt;Object&gt; eventQueue = postingState.eventQueue;
        //æ·»åŠ åˆ°é˜Ÿåˆ—
        eventQueue.add(event);
        //å¦‚æœé˜Ÿåˆ—æ²¡æœ‰åœ¨åˆ†å‘äº‹ä»¶å°±å¼€å§‹åˆ†å‘
        if (!postingState.isPosting) {
            postingState.isMainThread = Looper.getMainLooper() == Looper.myLooper();
            postingState.isPosting = true;
            if (postingState.canceled) {
                throw new EventBusException(&quot;Internal error. Abort state was not reset&quot;);
            }
            try {
                //å¾ªç¯æ‰§è¡Œåˆ†å‘
                while (!eventQueue.isEmpty()) {
                    postSingleEvent(eventQueue.remove(0), postingState);
                }
            } finally {
                postingState.isPosting = false;
                postingState.isMainThread = false;
            }
        }
}

private void postSingleEvent(Object event, PostingThreadState postingState) throws Error {
        Class&lt;?&gt; eventClass = event.getClass(); //äº‹ä»¶å‚æ•°ç±»å‹
        boolean subscriptionFound = false;
        if (eventInheritance) {  //default true
            List&lt;Class&lt;?&gt;&gt; eventTypes = lookupAllEventTypes(eventClass);
            int countTypes = eventTypes.size();
            for (int h = 0; h &lt; countTypes; h++) {
                Class&lt;?&gt; clazz = eventTypes.get(h);
                //åªè¦æœ‰ä¸€ä¸ªæˆåŠŸå°±è¿”å›æˆåŠŸ
                subscriptionFound |= postSingleEventForEventType(event, postingState, clazz);
            }
        } else {
            subscriptionFound = postSingleEventForEventType(event, postingState, eventClass);
        }
        //å¯¹é”™è¯¯çš„å¤„ç†ï¼Œå¯ä»¥è‡ªå·±æ³¨å†Œ`NoSubscriberEvent`æ¥æ•è·
        if (!subscriptionFound) {
            if (logNoSubscriberMessages) {
                Log.d(TAG, &quot;No subscribers registered for event &quot; + eventClass);
            }
            if (sendNoSubscriberEvent &amp;&amp; eventClass != NoSubscriberEvent.class &amp;&amp;
                    eventClass != SubscriberExceptionEvent.class) {
                post(new NoSubscriberEvent(this, event));
            }
        }
}

private static List&lt;Class&lt;?&gt;&gt; lookupAllEventTypes(Class&lt;?&gt; eventClass) {
        //eventTypesCache  K-&gt;äº‹ä»¶å‚æ•°çš„ç±»å‹   V-&gt;Kçš„æ‰€æœ‰çˆ¶ç±»çš„ç»“åˆï¼ˆåŒ…æ‹¬æœ¬èº«ï¼‰
        //å‘é€ä¸€ä¸ªå­ç±»å‹çš„äº‹ä»¶ï¼Œçˆ¶ç±»å‹çš„ä¹Ÿè¦æ±‚æ”¶åˆ°è¯¥äº‹ä»¶
        synchronized (eventTypesCache) {
            List&lt;Class&lt;?&gt;&gt; eventTypes = eventTypesCache.get(eventClass);
            if (eventTypes == null) {
                eventTypes = new ArrayList&lt;&gt;();
                Class&lt;?&gt; clazz = eventClass;
                while (clazz != null) {
                    eventTypes.add(clazz);
                    //é€’å½’æ·»åŠ æ‰€æœ‰çš„çˆ¶ç±»/æ¥å£
                    addInterfaces(eventTypes, clazz.getInterfaces());
                    clazz = clazz.getSuperclass();
                }
                eventTypesCache.put(eventClass, eventTypes);
            }
            return eventTypes;
        }
}
</code></pre>
<p>æ ¹æ®ä¸Šé¢çš„ä»£ç æŸ¥çœ‹ï¼ŒçŸ¥é“æ‰€æœ‰çš„äº‹ä»¶å‘é€éƒ½æ˜¯é€šè¿‡å‡½æ•°<code>postSingleEventForEventType()</code>å‘é€ã€‚ä¸‹é¢çœ‹çœ‹å…·ä½“çš„å®ç°ã€‚</p>
<pre><code class="language-java">/**
 * 
 * @param event  äº‹ä»¶æ•°æ®
 * @param postingState
 * @param eventClass  äº‹ä»¶å‚æ•°ç±»å‹
 * @return
 */
private boolean postSingleEventForEventType(Object event, PostingThreadState postingState, Class&lt;?&gt; eventClass) {
        CopyOnWriteArrayList&lt;Subscription&gt; subscriptions;
        synchronized (this) {
	    //subscriptionsByEventType K-&gt;æ–¹æ³•å‚æ•°çš„ç±»å‹   V-&gt;æ‰€æœ‰å‚æ•°ç±»å‹çš„Kçš„è®¢é˜…å‡½æ•°çš„é›†åˆ
            subscriptions = subscriptionsByEventType.get(eventClass);
        }
        if (subscriptions != null &amp;&amp; !subscriptions.isEmpty()) {
            for (Subscription subscription : subscriptions) {
                postingState.event = event;
                postingState.subscription = subscription;
                boolean aborted = false;
                try {
                    postToSubscription(subscription, event, postingState.isMainThread);
                    aborted = postingState.canceled;
                } finally {
                    postingState.event = null;
                    postingState.subscription = null;
                    postingState.canceled = false;
                }
                if (aborted) {
                    break;
                }
            }
            return true;
        }
        return false;
}

/**
 * @param subscription è®¢é˜…è€…
 * @param event        æ•°æ®
 * @param isMainThread å½“å‰çº¿ç¨‹æ˜¯å¦ä¸ºä¸»çº¿ç¨‹
 */
private void postToSubscription(Subscription subscription, Object event, boolean isMainThread) {
        switch (subscription.subscriberMethod.threadMode) {
            case POSTING:
                invokeSubscriber(subscription, event);
                break;
            case MAIN:
                if (isMainThread) {
                    invokeSubscriber(subscription, event);
                } else {
                    //mainThreadPoster = new HandlerPoster(this/*eventBus*/, Looper.getMainLooper(), 10);
                    // HandlerPoster extends Handler
                    mainThreadPoster.enqueue(subscription, event);
                }
                break;
            case BACKGROUND:
                if (isMainThread) {
                    backgroundPoster.enqueue(subscription, event);
                } else {
                    invokeSubscriber(subscription, event);
                }
                break;
            case ASYNC:
                asyncPoster.enqueue(subscription, event);
                break;
            default:
                throw new IllegalStateException(&quot;Unknown thread mode: &quot; + subscription.subscriberMethod.threadMode);
        }
}

</code></pre>
<p>è¿™é‡Œå°±æ˜¯<code>EventBus</code>å¯¹å››ç§çº¿ç¨‹æ¨¡å¼çš„ä¸åŒå¤„ç†ï¼Œè¿™é‡Œåªæ‹¿å‡ºå…¶ä¸­ä¸€ä¸ªæ¥è®²ã€‚å¯¹äº<code>MAIN</code>ï¼Œå¦‚æœå½“å‰<code>POST</code>çº¿ç¨‹å°±æ˜¯ä¸»çº¿ç¨‹ï¼Œé‚£ä¹ˆå½“ç„¶å°±æ˜¯ç›´æ¥è°ƒå¯¹åº”çš„å‡½æ•°å°±OK,å¦‚æœå½“å‰<code>POST</code>ä¸æ˜¯ä¸»çº¿ç¨‹ï¼Œé‚£ä¹ˆå°±è¦ç”¨<code>Handler</code>å‘é€åˆ°ä¸»çº¿ç¨‹ã€‚ä¸‹é¢çœ‹çœ‹å®ç°ã€‚</p>
<pre><code class="language-java">void enqueue(Subscription subscription, Object event) {
        //ç±»ä¼¼androidæºç ä¸­çš„Messageçš„è·å–æ–¹å¼
        PendingPost pendingPost = PendingPost.obtainPendingPost(subscription, event);
        synchronized (this) {
            //å¾…å‘é€çš„æ¶ˆæ¯åŠ å…¥é˜Ÿåˆ—
            queue.enqueue(pendingPost);
            if (!handlerActive) {
                handlerActive = true;
                if (!sendMessage(obtainMessage())) {
                    throw new EventBusException(&quot;Could not send handler message&quot;);
                }
            }
        }
}

@Override
public void handleMessage(Message msg) {
        boolean rescheduled = false;
        try {
            long started = SystemClock.uptimeMillis();
            while (true) {
                PendingPost pendingPost = queue.poll();
                if (pendingPost == null) {
                    synchronized (this) {
                        // Check again, this time in synchronized
                        pendingPost = queue.poll();
                        if (pendingPost == null) {
                            handlerActive = false;
                            return;
                        }
                    }
                }
                eventBus.invokeSubscriber(pendingPost); //ä½¿ç”¨EventBuså›è°ƒæ–¹æ³•
                long timeInMethod = SystemClock.uptimeMillis() - started;
                if (timeInMethod &gt;= maxMillisInsideHandleMessage) {
                    if (!sendMessage(obtainMessage())) {
                        throw new EventBusException(&quot;Could not send handler message&quot;);
                    }
                    rescheduled = true;
                    return;
                }
            }
        } finally {
            handlerActive = rescheduled;
        }
}
</code></pre>
<p>åœ¨<code>EventBus</code>ä¸­ï¼Œè°ƒç”¨æ³¨å†Œçš„æ–¹æ³•ã€‚</p>
<pre><code class="language-java">void invokeSubscriber(PendingPost pendingPost) {
        Object event = pendingPost.event;
        Subscription subscription = pendingPost.subscription;
        PendingPost.releasePendingPost(pendingPost);
        if (subscription.active) {
            invokeSubscriber(subscription, event);
        }
}

void invokeSubscriber(Subscription subscription, Object event) {
        try {
            subscription.subscriberMethod.method.invoke(subscription.subscriber, event);
        } catch (InvocationTargetException e) {
            handleSubscriberException(subscription, event, e.getCause());
        } catch (IllegalAccessException e) {
            throw new IllegalStateException(&quot;Unexpected exception&quot;, e);
        }
}
</code></pre>
<p>å¯ä»¥çœ‹å‡ºï¼Œåªæ˜¯å¾ˆç®€å•ç”¨åå°„è°ƒç”¨äº†è¦è°ƒäº†æ–¹æ³•ï¼Œåˆ°æ­¤å¯¹æ™®é€šäº‹ä»¶çš„åˆ†æå°±å®Œäº†ï¼Œä¸‹é¢çœ‹çœ‹ç²˜æ€§äº‹ä»¶ã€‚</p>
<pre><code class="language-java">//EventBus
public void postSticky(Object event) {
        synchronized (stickyEvents) {
            stickyEvents.put(event.getClass(), event);
        }
        // Should be posted after it is putted, in case the subscriber wants to remove immediately
        post(event);
}
</code></pre>
<p>ç»“åˆä¸Šé¢æ³¨å†Œçš„æ—¶å€™çš„ä»£ç åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“<code>postSticky()</code>çš„äº‹ä»¶ä¼šåœ¨<code>postSticky()</code>çš„æ—¶å€™å‘é€ä¸€æ¬¡ï¼Œå¹¶åœ¨æœ‰æ–°æ³¨å†Œç²˜æ€§äº‹ä»¶çš„æ—¶å€™ä¼šå†æ¬¡åŒ¹é…,æœ€åå°±æ˜¯çœ‹çœ‹äº‹ä»¶çš„è§£ç»‘ã€‚</p>
<h2 id="äº‹ä»¶çš„è§£ç»‘">äº‹ä»¶çš„è§£ç»‘</h2>
<pre><code class="language-java">/**
 * Unregisters the given subscriber from all event classes.
 */
 public synchronized void unregister(Object subscriber) {
        //æ³¨å†Œç±»çš„æ³¨å†Œå‡½æ•°çš„å‚æ•°çš„é›†åˆ
        List&lt;Class&lt;?&gt;&gt; subscribedTypes = typesBySubscriber.get(subscriber);
        if (subscribedTypes != null) {
            for (Class&lt;?&gt; eventType : subscribedTypes) {
                unsubscribeByEventType(subscriber, eventType);
            }
            typesBySubscriber.remove(subscriber);
        } else {
            Log.w(TAG, &quot;Subscriber to unregister was not registered before: &quot; + subscriber.getClass());
        }
}

/**
 * Only updates subscriptionsByEventType, not typesBySubscriber! Caller must update typesBySubscriber.
 *
 * @param subscriber æ³¨å†Œç±»
 * @param eventType  å‚æ•°Type
 */
private void unsubscribeByEventType(Object subscriber, Class&lt;?&gt; eventType) {
        //å–å¾—å‚æ•°ç±»å‹ä¸ºeventTypeçš„æ‰€æœ‰æ³¨å†Œå‡½æ•°çš„é›†åˆ
        List&lt;Subscription&gt; subscriptions = subscriptionsByEventType.get(eventType);
        if (subscriptions != null) {
            int size = subscriptions.size();
            for (int i = 0; i &lt; size; i++) {
                Subscription subscription = subscriptions.get(i);
                if (subscription.subscriber == subscriber) {
                    subscription.active = false;
                    subscriptions.remove(i);
                    i--;
                    size--;
                }
            }
        }
}
</code></pre>
<p>é€šè¿‡ä¸Šé¢çš„ä»£ç ï¼Œå¯ä»¥çœ‹å‡ºï¼Œå…¶å®äº‹ä»¶çš„ç§»é™¤å°±æ˜¯æŠŠå®ƒé‡<code>List</code>/<code>HashMap</code>ä¸­<code>remove</code>æ‰ã€‚</p>
<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<ul>
<li><a href="http://liuguoquan727.github.io/2016/04/18/Android%20EventBus3.0%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">Android EventBus3.0æºç è§£æ</a></li>
<li><a href="http://yydcdut.com/2016/03/07/eventbus3-code-analyse/">EventBus3.0æºç è§£æ by yydcdut</a></li>
<li><a href="http://yaohepeng.com/2016/03/11/Eventbus3-0%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">Eventbus3.0æºç è§£æ by yaohepeng</a></li>
</ul>
</span></p></div>
	<br>
	<hr>
<div style="color: #ccc;font-size:14px;"><i class="fa fa-user"></i>æœ¬æ–‡ç”±<a rel="license" href="/">KuTeat</a>åˆ›ä½œ</div>	
<div style="color: #ccc;font-size:14px;"><i class="fa fa-cc"></i>è¯¥æ–‡ç« é‡‡ç”¨<a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</div>
<div style="color: #ccc;font-size:14px;"><i class="fa fa-clock-o"></i>å‘å¸ƒæ—¶é—´ä¸ºï¼š2016-08-22</div>    
	 <p class="md_block">
    <div class="reward"><div class="reward-button">èµ <span class="reward-code"> <span class="alipay-code"> <img class="alipay-img" src="https://kutear.github.io/media/images/alipay.png"><b>æ”¯ä»˜å®æ‰«ç æ‰“èµ</b> </span> <span class="wechat-code"> <img class="wechat-img" src="https://kutear.github.io/media/images/wechat.png"><b>å¾®ä¿¡æ‰“èµ</b> </span> </span></div></div>
<div style="text-align:center;color: #ccc;font-size:14px;">å¦‚æœè§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå¯ä»¥è¯·ä½œè€…å–ä¸€æ¯é¥®æ–™å“¦ğŸ¥¤</div>    
</p> 
</div>
</div>

<style type="text/css">
#mememe {
	border:3px;
	border-radius:5px;
    background-repeat: no-repeat;
    height: 100%;
	width: 100%;
	display: inline-block;
	border-radius:5px; 
}
</style>

<script>
var link = "" ;
$("img").each( (i,o) => {
	var o = $(o);
	if( o.attr("src").indexOf("sinaimg") > 0 || o.attr("src").indexOf("qpic") > 0 || o.attr("src").indexOf("baidu") > 0 || o.attr("src").indexOf("sinaimg") > 0){
		o.attr("referrerpolicy","no-referrer");
		link = o.attr("src");
		o.attr("src",link);
	}
});
</script>

<div style="width:100%;overflow:hidden">

          <div style="float:right;text-align:right;color:#ccc;font-size:18px;width:50%;">
            ä¸‹ä¸€ç¯‡
            <a href="https://kutear.github.io/post/2016-07-28_Android_WebView_Comication_With_Js">
              <h3 class="post-title">
                Android WebViewåŒJsçš„äº¤äº’æ–¹æ¡ˆ
              </h3>
            </a>
          </div>



          <div style="float:left;text-align:left;color:#ccc;font-size:18px;width:50%;">
            ä¸Šä¸€ç¯‡
            <a href="https://kutear.github.io/post/2016-08-30-SparseArray">
              <h3 class="post-title">
                SparseArray åŸç†åˆ†æ
              </h3>
            </a>
          </div>

</div>

<div class="doc_comments">

</div>

  </div>
</div>


      </div>
<div class="toc-container">
<ul class="markdownIt-TOC">
<li><a href="#%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84%E4%BE%8B%E5%AD%90%E8%AF%B4%E8%B5%B7">æœ€ç®€å•çš„ä¾‹å­è¯´èµ·</a></li>
<li><a href="#eventbus-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90">EventBus æºç åˆ†æ</a>
<ul>
<li><a href="#%E4%B8%80%E5%88%87%E7%9A%84%E5%BC%80%E5%A7%8B-%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%AE%A2%E9%98%85">ä¸€åˆ‡çš„å¼€å§‹-äº‹ä»¶çš„è®¢é˜…</a></li>
<li><a href="#%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%8F%91%E9%80%81">äº‹ä»¶çš„å‘é€</a></li>
<li><a href="#%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%A7%A3%E7%BB%91">äº‹ä»¶çš„è§£ç»‘</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83">å‚è€ƒ</a></li>
</ul>

</div>
    </div>
	
   <div class="footer">
<div class="site_footer_wrap"><div class="site_footer">

      <div class="mysocials"><div class="my_socials">
		   
			   
    
			   
    
			   
    
			   
    
			   
    
			   
    
</div>
      </div>

      <div class="copyright" id="copyright">
	  <script>
		var date=new Date;
		var year=date.getFullYear(); 
		document.write("Copyright Â© "+year+" " + "KuTeat. ");
		</script>
		Powered by Gridea.
		<br>
		æœ¬ç«™å·²ç¨³å®šè¿è¡Œäº†
		<strong><script type="text/javascript">
		var urodz= new Date("10/28/2018");
		var now = new Date();
		var ile = now.getTime() - urodz.getTime();
		var dni = Math.floor(ile / (1000 * 60 * 60 * 24));
		document.write(+dni)
		</script>
		</strong>å¤©
		<br>
		æœ¬ç«™æ€»è®¿é—®é‡ä¸º <strong><span id="busuanzi_value_site_uv"></span></strong> æ¬¡
	  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
      </div>
	  <img src="https://kutear.github.io/media/images/font.svg">

    </div>

<script type="text/javascript" src="https://kutear.github.io/media/scripts/love.js"></script>
<script type="text/javascript" src="https://kutear.github.io/media/scripts/darkmode.js"></script>
<script>
var options = {
  bottom: '64px', // default: '32px'
  right: '32px', // default: '32px'
  left: 'unset', // default: 'unset'
  time: '0.5s', // default: '0.3s'
  mixColor: '#fff', // default: '#fff'
  backgroundColor: '#fff',  // default: '#fff'
  buttonColorDark: '#100f2c',  // default: '#100f2c'
  buttonColorLight: '#fff', // default: '#fff'
  saveInCookies: false, // default: true,
  label: 'ğŸŒ“', // default: ''
  autoMatchOsTheme: true // default: true
}

const darkmode = new Darkmode(options);
darkmode.showWidget();
</script>
<script>
hljs.initHighlightingOnLoad();
</script>

</body>

</html>
